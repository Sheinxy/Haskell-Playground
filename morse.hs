module Morse where

charToMorse :: Char -> String
charToMorse 'a'  = ".-"
charToMorse 'A'  = ".-"
charToMorse 'b'  = "-..."
charToMorse 'B'  = "-..."
charToMorse 'c'  = "-.-."
charToMorse 'C'  = "-.-."
charToMorse 'd'  = "-.."
charToMorse 'D'  = "-.."
charToMorse 'e'  = "."
charToMorse 'E'  = "."
charToMorse 'f'  = "..-."
charToMorse 'F'  = "..-."
charToMorse 'g'  = "--."
charToMorse 'G'  = "--."
charToMorse 'h'  = "...."
charToMorse 'H'  = "...."
charToMorse 'i'  = ".."
charToMorse 'I'  = ".."
charToMorse 'j'  = ".---"
charToMorse 'J'  = ".---"
charToMorse 'k'  = "-.-"
charToMorse 'K'  = "-.-"
charToMorse 'l'  = ".-.."
charToMorse 'L'  = ".-.."
charToMorse 'm'  = "--"
charToMorse 'M'  = "--"
charToMorse 'n'  = "-."
charToMorse 'N'  = "-."
charToMorse 'o'  = "---"
charToMorse 'O'  = "---"
charToMorse 'p'  = ".--."
charToMorse 'P'  = ".--."
charToMorse 'q'  = "--.-"
charToMorse 'Q'  = "--.-"
charToMorse 'r'  = ".-."
charToMorse 'R'  = ".-."
charToMorse 's'  = "..."
charToMorse 'S'  = "..."
charToMorse 't'  = "-"
charToMorse 'T'  = "-"
charToMorse 'u'  = "..-"
charToMorse 'U'  = "..-"
charToMorse 'v'  = "...-"
charToMorse 'V'  = "...-"
charToMorse 'w'  = ".--"
charToMorse 'W'  = ".--"
charToMorse 'x'  = "-..-"
charToMorse 'X'  = "-..-"
charToMorse 'y'  = "-.--"
charToMorse 'Y'  = "-.--"
charToMorse 'z'  = "--.."
charToMorse 'Z'  = "--.."
charToMorse '0'  = "-----"
charToMorse '1'  = ".----"
charToMorse '2'  = "..---"
charToMorse '3'  = "...--"
charToMorse '4'  = "....-"
charToMorse '5'  = "....."
charToMorse '6'  = "-...."
charToMorse '7'  = "--..."
charToMorse '8'  = "---.."
charToMorse '9'  = "----."
charToMorse '.'  = ".-.-.-"
charToMorse ','  = "--..--"
charToMorse '?'  = "..--.."
charToMorse '\'' = ".----."
charToMorse '!'  = "-.-.--"
charToMorse '/'  = "-..-."
charToMorse '('  = "-.--."
charToMorse ')'  = "-.--.-"
charToMorse '&'  = ".-..."
charToMorse ':'  = "---..."
charToMorse ';'  = "-.-.-"
charToMorse '='  = "-...-"
charToMorse '+'  = ".-.-."
charToMorse '-'  = "-....-"
charToMorse '_'  = "..--.-"
charToMorse '"'  = ".-..-."
charToMorse '$'  = "...-..-"
charToMorse '@'  = ".--.-."
charToMorse ' '  = "/"
charToMorse _    = "?"

stringToMorse :: String -> String
stringToMorse = init . concatMap ((++ " ") . charToMorse)

morseToChar :: String -> Char
morseToChar ".-"      = 'A' 
morseToChar "-..."    = 'B' 
morseToChar "-.-."    = 'C' 
morseToChar "-.."     = 'D' 
morseToChar "."       = 'E' 
morseToChar "..-."    = 'F' 
morseToChar "--."     = 'G' 
morseToChar "...."    = 'H' 
morseToChar ".."      = 'I' 
morseToChar ".---"    = 'J' 
morseToChar "-.-"     = 'K' 
morseToChar ".-.."    = 'L' 
morseToChar "--"      = 'M' 
morseToChar "-."      = 'N' 
morseToChar "---"     = 'O' 
morseToChar ".--."    = 'P' 
morseToChar "--.-"    = 'Q' 
morseToChar ".-."     = 'R' 
morseToChar "..."     = 'S' 
morseToChar "-"       = 'T' 
morseToChar "..-"     = 'U' 
morseToChar "...-"    = 'V' 
morseToChar ".--"     = 'W' 
morseToChar "-..-"    = 'X' 
morseToChar "-.--"    = 'Y' 
morseToChar "--.."    = 'Z' 
morseToChar "-----"   = '0' 
morseToChar ".----"   = '1' 
morseToChar "..---"   = '2' 
morseToChar "...--"   = '3' 
morseToChar "....-"   = '4' 
morseToChar "....."   = '5' 
morseToChar "-...."   = '6' 
morseToChar "--..."   = '7' 
morseToChar "---.."   = '8' 
morseToChar "----."   = '9' 
morseToChar ".-.-.-"  = '.' 
morseToChar "--..--"  = ',' 
morseToChar "..--.."  = '?' 
morseToChar ".----."  = '\'' 
morseToChar "-.-.--"  = '!' 
morseToChar "-..-."   = '/' 
morseToChar "-.--."   = '(' 
morseToChar "-.--.-"  = ')' 
morseToChar ".-..."   = '&' 
morseToChar "---..."  = ':' 
morseToChar "-.-.-"   = ';' 
morseToChar "-...-"   = '=' 
morseToChar ".-.-."   = '+' 
morseToChar "-....-"  = '-' 
morseToChar "..--.-"  = '_' 
morseToChar ".-..-."  = '"' 
morseToChar "...-..-" = '$' 
morseToChar ".--.-."  = '@' 
morseToChar "/"       = ' ' 
morseToChar _         = '?'

morseToString :: String -> String
morseToString = concatMap ((: []) . morseToChar) . words